<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<link th:rel="stylesheet" th:href="@{/webjars/bootstrap/5.3.2/css/bootstrap.min.css}"/>
	<link rel="stylesheet" th:href="@{/css/style.css}">
	<title>Pizzeria da Jama</title>
</head>
<body class="container d-flex flex-column align-items-center text-center">
	
	<h1 class="pt-5">Pizzeria da Jama</h1>
	
	<h4 sec:authorize="!hasAnyAuthority('ADMIN', 'USER')">
		<a class="btn btn-primary" href="/login">Login</a>		
	</h4>
	
	<h4 sec:authorize="hasAnyAuthority('ADMIN', 'USER')">
		<a class="btn btn-warning" href="/logout">Logout</a>				
	</h4>
	
	<form action="/" method="GET" class="py-3">
		<label>Cerca</label>
		<input type="text" name="nome" th:value="${nome}">
	</form>
	
	<div th:if="${pizze != null}">
		<ul class="p-0">
			<li 
				th:each="pizza : ${pizze}"
				th:object="${pizza}"
				class="d-flex justify-content-between align-items-center py-2 my-1 border border-dark rounded">
					<span class="px-2">
						<a th:href="@{/{id} (id = *{id})}">[[*{nome}]] - [[*{prezzo}]] â‚¬</a>
					</span>
					
					<div class= d-flex>
						<button 
							class="btn btn-secondary"
							sec:authorize="hasAnyAuthority('ADMIN')"	
						>
								<a th:href="@{/edit/{id} (id = *{id})}">Modifica</a>
						</button>

						<form class="px-1"
							th:action="@{/delete/{id} (id = *{id})}"
							method="post"
							sec:authorize="hasAnyAuthority('ADMIN')"
						>
								<button
									th:id="'delete-' + *{id}"	
									class="btn btn-danger" 
									type="submit">Elimina</button>
						</form>

					</div>
			</li>
		</ul>
	</div>


	<div class="d-flex my-3">
		<a 
			th:href="@{/create-update}"
			class="btn btn-primary"
			sec:authorize="hasAnyAuthority('ADMIN')"
		>Nuova pizza</a>
		
			<a 
			th:href="@{/ingredienti}"
			class="ms-3 btn btn-secondary"
			sec:authorize="hasAnyAuthority('ADMIN')"
		>Ingredienti</a>		
	</div>
	
	<h3 th:if="${pizze.isEmpty()}">Pizzeria chiusa</h3>
	
</body>
</html>